import{Player,player}from"../classes/player.js";import{camera,canvas,ctx,field,halfCanvas,level,mapObjects,previousCanvas}from"../variables/variables.js";import{maps}from"../variables/maps.js";import{Tree,Water,Wall,CubicZirconia}from"../classes/obstacles.js";import{Edge,EndLevel,ChangeStageOfLevel}from"../classes/control-points.js";import{Decor,Floor}from"../classes/floor.js";import{Tablet}from"../classes/tablets.js";import{objHints}from"../variables/list-hints.js";import{Item}from"../classes/items.js";import{objAudio}from"../variables/list-audio.js";import{resizeCanvas}from"./resize.js";import{Fence}from"../classes/fence.js";import{Interlocutor,Wounded,Lera}from"../classes/npc.js";import{Target}from"../classes/bullets.js";import{UniversityInFlesh}from"../classes/university-in-flesh.js";import{People}from"../classes/people.js";var itemIsNotSelected=!0;function levelGeneration(e,a){initPositions(e,a),generationMap(),addEventListener("resize",adaptGameField)}function initPositions(e,a){camera.currentPosition.x=e*field.sizeCell+field.sizeCell/2,camera.currentPosition.y=a*field.sizeCell+field.sizeCell/2,camera.currentPosition.startX=e*field.sizeCell+field.sizeCell/2,camera.currentPosition.startY=a*field.sizeCell+field.sizeCell/2,camera.beginningMap.x=0-(camera.currentPosition.startX-halfCanvas.w),camera.beginningMap.y=0-(camera.currentPosition.startY-halfCanvas.h),camera.beginningMap.startX=0-(camera.currentPosition.startX-halfCanvas.w),camera.beginningMap.startY=0-(camera.currentPosition.startY-halfCanvas.h),camera.edgeOfMap.x=maps[mapObjects.typeMap][0].length*field.sizeCell,camera.edgeOfMap.y=maps[mapObjects.typeMap].length*field.sizeCell,camera.edgeOfMap.startX=maps[mapObjects.typeMap][0].length*field.sizeCell,camera.edgeOfMap.startY=maps[mapObjects.typeMap].length*field.sizeCell}function generationMap(){switch(cleanMap(),mapObjects.typeMap){case"Tsaritsyno Park":player.x=canvas.width/2-field.sizeCell/6,player.y=canvas.height/2-field.sizeCell/4,player.width=field.sizeCell/3,player.height=field.sizeCell/2,player.image.stateOfRest.left.src="./images/player/state-of-rest-left.png",player.image.stateOfRest.right.src="./images/player/state-of-rest-right.png",player.image.movementStatus.left.src="./images/player/movement-status-left.png",player.image.movementStatus.right.src="./images/player/movement-status-right.png",player.image.heals.left.src="",player.image.heals.right.src="",player.image.beats.right.src="",player.image.beats.left.src="",maps[mapObjects.typeMap].forEach(function(e,t){e.forEach(function(a,e){if(a.match(/\//)&&mapObjects.edge.push(new Edge(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell+1)),a.match(/end/)&&(mapObjects.endLevel=new EndLevel(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell+1)),a.match(/\s/)&&mapObjects.water.push(new Water(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell+1,"./images/water/water-sprite.png")),a.match(/_\d+/)&&mapObjects.floor.push(new Floor(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell+1,"./images/floor/lawn.png",a.substr(a.indexOf("_")+1,2))),a.match(/d\d+/)&&mapObjects.decor.push(new Decor(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell+1,"./images/floor/decor.png",a.substr(a.indexOf("d")+1,2))),a.match(/t/)&&mapObjects.tree.push(new Tree(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell/3+1,field.sizeCell,"./images/tree/tree-sprite.png")),a.match(/h\d+/)&&mapObjects.tablet.push(new Tablet(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),3*field.sizeCell/4,objHints[parseInt(a.substr(a.indexOf("h")+1,2))],"./images/tablet/tablet.png","./images/tablet/tablet-hint.png")),a.match(/i\d+/)&&(player.playerTasks.backpack.forEach(function(e){e==="i".concat(String(parseInt("".concat(a[a.indexOf("i")+1]).concat(a[a.indexOf("i")+2]))))&&(itemIsNotSelected=!1)}),itemIsNotSelected?mapObjects.item.push(new Item(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell/4,a.substr(a.indexOf("i")+1,2))):itemIsNotSelected=!0),a.match(/n[A-Z]+/))switch(a[a.indexOf("n")+1]){case"B":mapObjects.npc.interlocutor.push(new Interlocutor(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w)+2*field.sizeCell/3,t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h)-field.sizeCell/3,field.sizeCell/3,field.sizeCell/2*1.3,"Borya",player.stageOfConversation.Borya,objAudio.NPC.Borya,"./images/characters/borya.png",364));break;case"D":mapObjects.npc.interlocutor.push(new Interlocutor(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w)+field.sizeCell/3,t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h)+field.sizeCell/3,field.sizeCell/3,field.sizeCell/2*1.1,"Danya",player.stageOfConversation.Danya,objAudio.NPC.Danya,"./images/characters/danya.png",308));break;case"M":mapObjects.npc.interlocutor.push(new Interlocutor(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w)+field.sizeCell/3,t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h)+field.sizeCell/3,field.sizeCell/3,field.sizeCell/2*1.1,"Mark",player.stageOfConversation.Mark,objAudio.NPC.Mark,"./images/characters/mark.png",308));break;case"A":mapObjects.npc.interlocutor.push(new Interlocutor(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w)+2*field.sizeCell/3,t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h)+field.sizeCell/3,field.sizeCell/3,field.sizeCell/2*.9,"Alina",player.stageOfConversation.Alina,objAudio.NPC.Alina,"./images/characters/alina.png",252));break;case"K":mapObjects.npc.interlocutor.push(new Interlocutor(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w)+field.sizeCell/3,t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h)+field.sizeCell/3,field.sizeCell/3,field.sizeCell/2*1.1,"Kolya",player.stageOfConversation.Kolya,objAudio.NPC.Kolya,"./images/characters/kolya.png",308))}})});break;case"Night Parish":player.x=5*field.sizeCell/3,player.y=canvas.height/2-field.sizeCell/4,player.width=field.sizeCell/3,player.height=field.sizeCell/2,player.currentDirection="right",player.image.stateOfRest.left.src="",player.image.stateOfRest.right.src="./images/player/home-state-of-rest-right.png",player.image.movementStatus.left.src="",player.image.movementStatus.right.src="",player.image.heals.left.src="",player.image.heals.right.src="",player.image.beats.right.src="",player.image.beats.left.src="",0===mapObjects.UniversityInFlesh.length?mapObjects.UniversityInFlesh.push(new UniversityInFlesh(canvas.width-3*field.sizeCell,field.sizeCell,1.5*field.sizeCell,2*field.sizeCell)):(mapObjects.UniversityInFlesh[0].x=canvas.width-3*field.sizeCell,mapObjects.UniversityInFlesh[0].y=field.sizeCell,mapObjects.UniversityInFlesh[0].currentPositionX=camera.currentPosition.x,mapObjects.UniversityInFlesh[0].currentPositionY=camera.currentPosition.y,mapObjects.UniversityInFlesh[0].width=1.5*field.sizeCell,mapObjects.UniversityInFlesh[0].height=2*field.sizeCell),maps[mapObjects.typeMap].forEach(function(e,t){e.forEach(function(e,a){e.match(/_\d+/)&&mapObjects.floor.push(new Floor(a*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell,"./images/floor/wooden-floor.png",e.substr(e.indexOf("_")+1,2)))})});break;case"Basements Of War":player.x=canvas.width/2-field.sizeCell/6,player.y=canvas.height/2-field.sizeCell/4,player.width=field.sizeCell/3,player.height=field.sizeCell/2,player.image.stateOfRest.left.src="./images/player/dungeon-state-of-rest-left.png",player.image.stateOfRest.right.src="./images/player/dungeon-state-of-rest-right.png",player.image.movementStatus.left.src="./images/player/dungeon-movement-status-left.png",player.image.movementStatus.right.src="./images/player/dungeon-movement-status-right.png",player.image.heals.left.src="./images/player/dungeon-heal-status-left.png",player.image.heals.right.src="./images/player/dungeon-heal-status-right.png",player.image.beats.right.src="",player.image.beats.left.src="",maps[mapObjects.typeMap].forEach(function(e,t){e.forEach(function(a,e){if(a.match(/\//)&&mapObjects.edge.push(new Edge(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell+1)),a.match(/end/)&&(mapObjects.endLevel=new EndLevel(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell+1)),a.match(/_\d+/)&&mapObjects.floor.push(new Floor(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell,"./images/floor/stone-floor.png",a.substr(a.indexOf("_")+1,2))),a.match(/d\d+/)&&mapObjects.decor.push(new Decor(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell+1,"./images/floor/dungeon-decor.png",a.substr(a.indexOf("d")+1,2))),a.match(/\|\d+/)&&mapObjects.wall.push(new Wall(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-field.sizeCell/2-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell,a.substr(a.indexOf("|")+1,2))),a.match(/h\d+/)&&mapObjects.tablet.push(new Tablet(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),3*field.sizeCell/4,objHints[parseInt(a.substr(a.indexOf("h")+1,2))],"./images/tablet/dungeon-tablet.png","./images/tablet/dungeon-tablet-hint.png")),a.match(/i\d+/)&&(player.playerTasks.backpack.forEach(function(e){e==="i".concat(String(parseInt("".concat(a[a.indexOf("i")+1]).concat(a[a.indexOf("i")+2]))))&&(itemIsNotSelected=!1)}),itemIsNotSelected?mapObjects.item.push(new Item(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell/4,a.substr(a.indexOf("i")+1,2))):itemIsNotSelected=!0),a.match(/n[A-Z]+/))switch(a[a.indexOf("n")+1]){case"V":mapObjects.npc.interlocutor.push(new Interlocutor(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w)+2*field.sizeCell/3,t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h)-field.sizeCell/3,field.sizeCell/3,field.sizeCell/2*1.2,"Vlad",player.stageOfConversation.Vlad,objAudio.NPC.Vlad,"./images/characters/vlad.png",336));break;case"D":mapObjects.npc.interlocutor.push(new Interlocutor(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w)+field.sizeCell/3,t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h)+field.sizeCell/3,field.sizeCell/3,field.sizeCell/2,"Drunk",player.stageOfConversation.Drunk,objAudio.NPC.Drunk,"./images/characters/drunk.png",280));break;case"W":mapObjects.npc.wounded.push(new Wounded(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w)+field.sizeCell/3,t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h)+field.sizeCell/3,field.sizeCell/3,field.sizeCell/2*.8,"Wounded",objAudio.NPC.Wounded,196,224,player.playerTasks.completedDialogues.Wounded,player.stageOfConversation.Wounded))}a.match(/p\d+/)&&mapObjects.people.push(new People(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell,a.substr(a.indexOf("p")+1,2)))})});break;case"Battlefield":player.x=canvas.width/2-field.sizeCell/6,player.y=canvas.height/2-field.sizeCell/4,player.width=field.sizeCell/3,player.height=field.sizeCell/2,player.image.stateOfRest.left.src="./images/player/battlefield-state-of-rest-left.png",player.image.stateOfRest.right.src="./images/player/battlefield-state-of-rest-right.png",player.image.movementStatus.left.src="./images/player/battlefield-movement-status-left.png",player.image.movementStatus.right.src="./images/player/battlefield-movement-status-right.png",player.image.heals.left.src="",player.image.heals.right.src="",player.image.beats.right.src="",player.image.beats.left.src="",maps[mapObjects.typeMap].forEach(function(e,t){e.forEach(function(a,e){a.match(/\//)&&mapObjects.edge.push(new Edge(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell+1)),a.match(/end/)&&(mapObjects.endLevel=new EndLevel(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell+1)),a.match(/\s/)&&mapObjects.water.push(new Water(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell+1,"./images/water/dead-water-sprite.png")),a.match(/_\d+/)&&mapObjects.floor.push(new Floor(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell+1,"./images/floor/dead-lawn.png",a.substr(a.indexOf("_")+1,2))),a.match(/d\d+/)&&mapObjects.decor.push(new Decor(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell+1,"./images/floor/dead-decor.png",a.substr(a.indexOf("d")+1,2))),a.match(/[^et]t([^a]|$)/)&&mapObjects.tree.push(new Tree(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell/3+1,field.sizeCell,"./images/tree/dead-tree-sprite.png")),a.match(/h\d+/)&&mapObjects.tablet.push(new Tablet(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),3*field.sizeCell/4,objHints[parseInt(a.substr(a.indexOf("h")+1,2))],"./images/tablet/dead-tablet.png","./images/tablet/dead-tablet-hint.png")),a.match(/i\d+/)&&(player.playerTasks.backpack.forEach(function(e){e==="i".concat(String(parseInt("".concat(a[a.indexOf("i")+1]).concat(a[a.indexOf("i")+2]))))&&(itemIsNotSelected=!1)}),itemIsNotSelected?mapObjects.item.push(new Item(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell/4,a.substr(a.indexOf("i")+1,2))):itemIsNotSelected=!0),a.match(/\|\d+/)&&mapObjects.wall.push(new Wall(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-field.sizeCell/2-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell,a.substr(a.indexOf("|")+1,2))),a.match(/target/)&&mapObjects.target.push(new Target(e*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell+1))})});break;case"Lawn Of Lera":player.x=canvas.width/2-field.sizeCell/6,player.y=canvas.height/2-field.sizeCell/4,player.width=field.sizeCell/3,player.height=field.sizeCell/2,player.image.stateOfRest.left.src="./images/player/state-of-rest-left.png",player.image.stateOfRest.right.src="./images/player/state-of-rest-right.png",player.image.movementStatus.left.src="./images/player/movement-status-left.png",player.image.movementStatus.right.src="./images/player/movement-status-right.png",player.image.heals.left.src="",player.image.heals.right.src="",player.image.beats.right.src="./images/player/beat-status-right.png",player.image.beats.left.src="./images/player/beat-status-left.png",maps[mapObjects.typeMap].forEach(function(e,l){e.forEach(function(a,t){a.match(/\//)&&mapObjects.edge.push(new Edge(t*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),l*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell+1)),a.match(/end/)&&(mapObjects.endLevel=new EndLevel(t*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),l*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell+1)),a.match(/\s/)&&mapObjects.water.push(new Water(t*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),l*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell+1,"./images/water/water-sprite.png")),a.match(/_\d+/)&&mapObjects.floor.push(new Floor(t*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),l*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell+1,"./images/floor/lawn.png",a.substr(a.indexOf("_")+1,2))),a.match(/d\d+/)&&mapObjects.decor.push(new Decor(t*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),l*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell+1,"./images/floor/decor.png",a.substr(a.indexOf("d")+1,2))),a.match(/t/)&&mapObjects.tree.push(new Tree(t*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),l*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell/3+1,field.sizeCell,"./images/tree/tree-sprite.png")),a.match(/f\d+/g)&&a.match(/f\d+/g).forEach(function(e){mapObjects.fence.push(new Fence(t*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),l*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell,"./images/fence/fence.png",{x:+e[e.indexOf("f")+1],y:+e[e.indexOf("f")+2]}))}),a.match(/h\d+/)&&mapObjects.tablet.push(new Tablet(t*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),l*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),3*field.sizeCell/4,objHints[parseInt(a.substr(a.indexOf("h")+1,2))],"./images/tablet/tablet.png","./images/tablet/tablet-hint.png")),a.match(/i\d+/)&&(player.playerTasks.backpack.forEach(function(e){e==="i".concat(String(parseInt("".concat(a[a.indexOf("i")+1]).concat(a[a.indexOf("i")+2]))))&&(itemIsNotSelected=!1)}),itemIsNotSelected?mapObjects.item.push(new Item(t*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),l*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell/4,a.substr(a.indexOf("i")+1,2))):itemIsNotSelected=!0),a.match(/n[A-Z]+/)&&"L"===a[a.indexOf("n")+1]&&mapObjects.npc.lera.push(new Lera(t*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w)+2*field.sizeCell/3,l*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h)-field.sizeCell/3,field.sizeCell/3*.9,field.sizeCell/2,"Lera",player.stageOfConversation.Lera,objAudio.NPC.Lera,176,280))})});break;case"Inner World":player.x=canvas.width/2-field.sizeCell/4,player.y=canvas.height/2-field.sizeCell/4,player.width=field.sizeCell/3,player.height=field.sizeCell/3,player.image.stateOfRest.left.src="",player.image.stateOfRest.right.src="",player.image.movementStatus.left.src="",player.image.movementStatus.right.src="",player.image.heals.left.src="",player.image.heals.right.src="",player.image.beats.right.src="",player.image.beats.left.src="",maps[mapObjects.typeMap].forEach(function(e,t){e.forEach(function(e,a){e.match(/\//)&&mapObjects.edge.push(new Edge(a*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell+1)),e.match(/stage\d/)&&level.levelStage!==+e[e.indexOf("stage")+5]&&mapObjects.stage.push(new ChangeStageOfLevel(a*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell+1,+e[e.indexOf("stage")+5])),e.match(/\|\d?/)&&(3===level.levelStage?mapObjects.cubicZirconia.push(new CubicZirconia(a*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-field.sizeCell/2-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell,"neutral")):"0"===e[e.indexOf("|")+1]?mapObjects.cubicZirconia.push(new CubicZirconia(a*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-field.sizeCell/2-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell,"absent")):mapObjects.cubicZirconia.push(new CubicZirconia(a*field.sizeCell-(camera.currentPosition.startX-halfCanvas.w),t*field.sizeCell-field.sizeCell/2-(camera.currentPosition.startY-halfCanvas.h),field.sizeCell)))})})}}function cleanMap(){mapObjects.edge=[],mapObjects.target=[],mapObjects.stage=[],mapObjects.water=[],mapObjects.tree=[],mapObjects.wall=[],mapObjects.fence=[],mapObjects.cubicZirconia=[],mapObjects.floor=[],mapObjects.decor=[],mapObjects.tablet=[],mapObjects.item=[],mapObjects.npc.interlocutor=[],mapObjects.npc.wounded=[],mapObjects.npc.lera=[],mapObjects.people=[],mapObjects.playerSimulator=[],mapObjects.bullet=[],mapObjects.shell=[],mapObjects.demon=[],mapObjects.particlePlayer=[],mapObjects.particleDemon=[],mapObjects.particleBlick=[],mapObjects.particleDeadBlick=[],mapObjects.shellBlick=[]}function adaptGameField(){resizeCanvas(),"Introduction"!==mapObjects.typeMap&&(canvas.height===previousCanvas.h&&canvas.width!==previousCanvas.w?(player.x+=(canvas.width-previousCanvas.w)/2,player.x<=1&&(player.x=1),player.x+player.width>=canvas.width&&(player.x=canvas.width-player.width)):(player.x+=(canvas.width-previousCanvas.w)/2,player.x<=1&&(player.x=1),player.x+player.width>=canvas.width&&(player.x=canvas.width-player.width),"Night Parish"!==mapObjects.typeMap&&(player.x<=mapObjects.edge[0].x&&(player.x=mapObjects.edge[0].x),player.x+player.width>=mapObjects.edge[1].x+mapObjects.edge[1].size)&&(player.x=mapObjects.edge[1].x+mapObjects.edge[1].size-player.width),player.y=canvas.height/(previousCanvas.h/(player.y+player.height/2))-player.height/2,player.width=field.sizeCell/3,player.height=field.sizeCell/2,Player.speed=field.speed*player.debuffSpeed,adaptingPositions(canvas.height/previousCanvas.h))),generationMap(),previousCanvas.w=canvas.width,previousCanvas.h=canvas.height}function adaptingPositions(e){camera.currentPosition.x*=e,camera.currentPosition.y*=e,camera.currentPosition.startX*=e,camera.currentPosition.startY*=e,camera.beginningMap.x*=e,camera.beginningMap.y*=e,camera.beginningMap.startX*=e,camera.beginningMap.startY*=e,camera.edgeOfMap.x*=e,camera.edgeOfMap.y*=e,camera.edgeOfMap.startX*=e,camera.edgeOfMap.startY*=e}function changePositions(){camera.beginningMap.x=camera.beginningMap.startX-(camera.currentPosition.x-camera.currentPosition.startX),camera.beginningMap.y=camera.beginningMap.startY-(camera.currentPosition.y-camera.currentPosition.startY),camera.edgeOfMap.x=camera.edgeOfMap.startX-(camera.currentPosition.x-camera.currentPosition.startX),camera.edgeOfMap.y=camera.edgeOfMap.startY-(camera.currentPosition.y-camera.currentPosition.startY)}function renderingCountItems(){ctx.fillStyle="#A32653",ctx.font="900 ".concat(field.sizeCell/10,"px Pixel Art"),ctx.textBaseline="alphabetic",ctx.textAlign="start",ctx.fillText("Осталось на локации: ".concat(mapObjects.item.length),.75*field.sizeCell,field.sizeCell/3)}function renderingNumberOfLives(){ctx.fillStyle="#57143c",ctx.fillRect(field.sizeCell/8,field.sizeCell/8,field.sizeCell,field.sizeCell/8),ctx.fillStyle="#E0329A",ctx.fillRect(field.sizeCell/8,field.sizeCell/8,field.sizeCell*(player.numberOfLives/100),field.sizeCell/8)}function renderingNumberOfLivesBoss(e){switch(e){case"University":ctx.fillStyle="white",ctx.font="900 ".concat(field.sizeCell/13,"px Pixel Art"),ctx.textBaseline="middle",ctx.textAlign="center",ctx.fillText("Универ Во Плоти",canvas.width/2,field.sizeCell/8),ctx.fillStyle="#450015",ctx.fillRect(canvas.width/2-field.sizeCell,field.sizeCell/4,2*field.sizeCell,field.sizeCell/8),ctx.fillStyle="#A38787",ctx.fillRect(canvas.width/2-field.sizeCell,field.sizeCell/4,2*field.sizeCell*mapObjects.UniversityInFlesh[0].numberOfLives/mapObjects.UniversityInFlesh[0].maxLives,field.sizeCell/8);break;case"Blick":ctx.fillStyle="white",ctx.font="900 ".concat(field.sizeCell/13,"px Pixel Art"),ctx.textBaseline="middle",ctx.textAlign="center",ctx.fillText("Верховный демон",canvas.width/2,field.sizeCell/8),ctx.fillStyle="#25004f",ctx.fillRect(canvas.width/2-field.sizeCell,field.sizeCell/4,2*field.sizeCell,field.sizeCell/8),ctx.fillStyle="#6500C9",ctx.fillRect(canvas.width/2-field.sizeCell,field.sizeCell/4,2*field.sizeCell*mapObjects.CorruptedMadBlick[0].numberOfLives/mapObjects.CorruptedMadBlick[0].maxLives,field.sizeCell/8)}}export{levelGeneration,initPositions,generationMap,cleanMap,adaptGameField,adaptingPositions,changePositions,renderingCountItems,renderingNumberOfLives,renderingNumberOfLivesBoss};