var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}))(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function s(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(s.prototype=i.prototype,new s)}}();import{camera,canvas,ctx,keys}from"../variables/variables.js";import{objAudio}from"../variables/list-audio.js";import{TemplateCell}from"./template.js";var Player=function(){function t(){this.amplitude=0,this.amplitudeSpeed=.1,this.action="worth",this.currentDirection="right",this.image={stateOfRest:{left:new Image,right:new Image},movementStatus:{left:new Image,right:new Image},beats:{left:new Image,right:new Image},heals:{left:new Image,right:new Image}},this.numberOfCompletedFrames=0,this.frame=-1,this.numberOfFrames=10,this.color="#e0329a",this.transparentColor="rgba(224,50,154,0)",this.speedX=0,this.speedY=0,this.debuffSpeed=1,this.numberOfLives=100,this.numberOfDeaths=0,this.takesDamage=!1,this.bossFightStage=!1,this.attack=!1,this.recharge=0,this.timeWithoutAttacks=0,this.mouseX=0,this.mouseY=0,this.numberOfEnemiesKilled={demon:0,CorruptedMadBlick:0},this.audio={walkingLawn:objAudio.player[0],walkingStone:objAudio.player[1],flight:objAudio.player[2],pickUp:objAudio.player[3],openTablet:objAudio.player[4],laLaLa:objAudio.player[5],la:objAudio.player[6]},this.thinks=!1,this.permissionMovement=!0,this.stageOfConversation={Borya:0,Danya:0,Mark:0,Alina:0,Kolya:0,Vlad:0,Drunk:0,Wounded:0,Lera:0},this.playerTasks={completedDialogues:{Borya:!1,Danya:!1,Mark:!1,Alina:!1,Kolya:!1,Vlad:!1,Drunk:!1,Wounded:!1,Lera:!1,soulKolya:!1},backpack:[],memories:new Set}}return t.prototype.drawPlayer=function(){switch(this.action){case"worth":ctx.drawImage(this.image.stateOfRest[this.currentDirection],196*this.frame+1,0,195,280,this.x,this.y,this.width,this.height);break;case"moving":ctx.drawImage(this.image.movementStatus[this.currentDirection],196*this.frame+1,0,195,280,this.x,this.y,this.width,this.height);break;case"heals":"left"===this.currentDirection?ctx.drawImage(this.image.heals.left,196*this.frame+1,0,195,280,this.x,this.y,this.width,this.height):ctx.drawImage(this.image.heals.right,196*this.frame+1,0,195,280,this.x,this.y,this.width,this.height);break;case"beats":"left"===this.currentDirection?ctx.drawImage(this.image.beats.left,196*this.frame+1,0,195,280,this.x,this.y,this.width,this.height):ctx.drawImage(this.image.beats.right,196*this.frame+1,0,195,280,this.x,this.y,this.width,this.height)}},t.prototype.drawSoul=function(){ctx.fillStyle=this.colorGradient,ctx.fillRect(this.x-.1*this.width,this.y-.1*this.width+this.amplitude,1.2*this.width,1.2*this.width)},t.prototype.motionless=function(){this.action="worth",this.numberOfFrames=27,this.numberOfCompletedFrames%8==0&&this.frame++,this.frame>=this.numberOfFrames&&(this.frame=0),this.drawPlayer()},t.prototype.movementPlayer=function(){this.x+=this.speedX,this.y+=this.speedY,"heals"!==this.action&&"beats"!==this.action&&(keys.a.pressed||keys.d.pressed||keys.w.pressed||keys.s.pressed?(this.action="moving",this.numberOfFrames=16):(this.action="worth",this.numberOfFrames=27)),"heals"===this.action&&(this.numberOfFrames=14),"beats"===this.action&&(this.numberOfFrames=8),this.numberOfCompletedFrames%8==0&&this.frame++,this.frame>=this.numberOfFrames&&("heals"!==this.action&&"beats"!==this.action||(this.action="worth",this.thinks=!1,keys.f.pause=!1),this.frame=0),this.drawPlayer(),this.speedX=0,this.speedY=0},t.prototype.movementSoul=function(){0===this.numberOfCompletedFrames&&(this.frame=0),this.x+=this.speedX,this.y+=this.speedY,keys.a.pressed||keys.d.pressed||keys.w.pressed||keys.s.pressed?this.action="moving":this.action="worth",0===this.frame?(this.amplitude+=this.amplitudeSpeed,12<=this.amplitude&&(this.frame=1)):(this.amplitude-=this.amplitudeSpeed,this.amplitude<=0&&(this.frame=0)),this.colorGradient=ctx.createRadialGradient(this.x+this.width/2,this.y+this.width/2+this.amplitude,this.width/4,this.x+this.width/2,this.y+this.width/2+this.amplitude,.6*this.width),this.colorGradient.addColorStop(.8,this.color),this.colorGradient.addColorStop(1,this.transparentColor),this.drawSoul(),this.speedX=0,this.speedY=0},t.speed=8,t}(),PlayerSimulator=function(e){function t(t,i,s){t=e.call(this,t,i,s)||this;return t.opacity=1,t.color="224, 50, 154",t.x+=.5*t.size,t.y+=.5*t.size,t.startX=t.x,t.startY=t.y,t.startPositionX=camera.currentPosition.x,t.startPositionY=camera.currentPosition.y,t}return __extends(t,e),t.prototype.draw=function(){ctx.fillStyle=this.colorGradient,ctx.fillRect(this.x-.6*this.size,this.y-.6*this.size,1.2*this.size,1.2*this.size)},t.prototype.changePositions=function(){this.x=this.startX+(this.startPositionX-camera.currentPosition.x),this.y=this.startY+(this.startPositionY-camera.currentPosition.y),this.size*=.98,this.opacity-=.05,this.colorGradient=ctx.createRadialGradient(this.x,this.y,this.size/4,this.x,this.y,.6*this.size),this.colorGradient.addColorStop(.8,"rgba(".concat(this.color,", ").concat(this.opacity,")")),this.colorGradient.addColorStop(1,"rgba(".concat(this.color,", 0)")),this.draw()},t}(TemplateCell),Shell=function(r){function t(t,i,s,e,a,h){t=r.call(this,t,i,s)||this;return t.color="224, 50, 154",t.opacity=1,t.shadowX=0,t.shadowY=0,t.numberOfShadows=5,t.constSpeed=canvas.height/40*.25,t.startSize=t.size,t.x+=e/2-t.size/2,t.y+=e/2-t.size/2,t.startX=t.x,t.startY=t.y,t.targetX=2*a-t.size/2,t.targetY=2*h-t.size/2,t.currentPositionX=camera.currentPosition.x,t.currentPositionY=camera.currentPosition.y,t.x<t.targetX?t.speedX=t.constSpeed:t.speedX=-t.constSpeed,t.y<t.targetY?t.speedY=t.constSpeed:t.speedY=-t.constSpeed,t.hypot=Math.abs(Math.hypot(t.startX-t.targetX,t.startY-t.targetY)),t.sin=Math.abs((t.startY-t.targetY)/t.hypot),t.cos=Math.abs((t.startX-t.targetX)/t.hypot),t}return __extends(t,r),t.prototype.draw=function(){for(var t=0;t<this.numberOfShadows;t++)this.colorGradient=ctx.createRadialGradient(this.x+.5*this.size-this.shadowX,this.y+.5*this.size-this.shadowY,this.size/4,this.x+.5*this.size-this.shadowX,this.y+.5*this.size-this.shadowY,.6*this.size),this.colorGradient.addColorStop(.8,"rgb(".concat(this.color,", ").concat(this.opacity,")")),this.colorGradient.addColorStop(1,"rgba(".concat(this.color,", 0)")),ctx.fillStyle=this.colorGradient,ctx.fillRect(this.x-this.size-this.shadowX,this.y-this.size-this.shadowY,3*this.size,3*this.size),this.shadowX+=this.speedX*this.cos,this.shadowY+=this.speedY*this.sin,this.opacity-=.1,--this.size},t.prototype.changePositions=function(){this.x+=this.cos*this.speedX+(this.currentPositionX-camera.currentPosition.x),this.y+=this.sin*this.speedY+(this.currentPositionY-camera.currentPosition.y),this.currentPositionX=camera.currentPosition.x,this.currentPositionY=camera.currentPosition.y,this.shadowX=0,this.shadowY=0,this.opacity=1,this.size=this.startSize,player.numberOfCompletedFrames%10==0&&this.numberOfShadows<10&&this.numberOfShadows++,this.draw()},t}(TemplateCell),player=new Player;export{Player,PlayerSimulator,Shell,player};